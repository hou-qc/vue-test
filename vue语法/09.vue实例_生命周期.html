<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vue实例_生命周期</title>
</head>

<body>
    <!--
1. vue对象的生命周期
  1). 初始化显示
    * beforeCreate()
    * created()
    * beforeMount()
    * mounted()
  2). 更新状态
    * beforeUpdate()
    * updated()
  3). 销毁vue实例: vm.$destory()
    * beforeDestory()
    * destoryed()
2. 常用的生命周期方法
  created()/mounted(): 发送ajax请求, 启动定时器等异步任务
  beforeDestory(): 做收尾工作, 如: 清除定时器
-->
    <div id="app">
        <button @click="destroy">destroy vue</button>
        <p v-show="isShow">xxx</p>
    </div>

    <script src="./vue.js"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    isShow: true,
                }
            },
            /*  
                mounted() 
                界面初始显示之后立即执行
                一般在此执行异步操作：发送ajax请求/启动定时器/订阅消息/绑定自定义事件监听
            */
            mounted() {
                // setInterval(() => {  //this指向vm
                //     this.isShow = !this.isShow;
                // }, 1000)

                //将intervalId保存到vm上
                this.intervalId = setInterval(function () {
                    this.isShow = !this.isShow;
                }.bind(this), 1000)  //使shi指向vm
                /* 
                1. 返回一个新函数
                2. 新函数内部会调用原函数(通过call调用)
                3. 在调用时指定原函数执行的this为bind()的第一个参数的值
                */
            },
            /*
                在vm死亡之前调用
                在此做一些收尾工作
            */
            beforeDestroy() {
                clearInterval(this.intervalId); //清除定时器
            },
            methods: {
                destroy() {
                    this.$destroy();  //消灭vm
                }
            },
        })
    </script>
</body>

</html>